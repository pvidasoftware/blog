<!DOCTYPE html>
<html lang="es">
<head>
<meta content="text/html; charset=" http-equiv="Content-Type">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<meta content="Asciidoctor 1.5.4" name="generator">
<meta content="Jorge Aguilera" name="author">
<title>Testea y Documenta tu API REST</title>
<link href="./../../../css/asciidoctor.css" rel="stylesheet">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
<link href="/blog/deck/core/deck.core.css" rel="stylesheet">
<link href="/blog/deck/extensions/scale/deck.scale.css" media="screen" rel="stylesheet">
<link href="/blog/deck/extensions/goto/deck.goto.css" media="screen" rel="stylesheet">
<link href="/blog/deck/extensions/navigation/deck.navigation.css" media="screen" rel="stylesheet">
<link href="/blog/deck/extensions/status/deck.status.css" media="screen" rel="stylesheet">
<link href="/blog/deck/themes/style/web-2.0.css" media="screen" rel="stylesheet">
<link href="/blog/deck/themes/transition/horizontal-slide.css" media="screen" rel="stylesheet">
<link href="/blog/deck/core/print.css" media="print" rel="stylesheet">
<link href="/blog/deck/../css/custom-deck.css" media="all" rel="stylesheet">
<script src="/blog/deck/modernizr.custom.js"></script>
</head>
<body class="article">
<div class="deck-container">
<section class="slide" id="title-slide">
<h1>Testea y Documenta tu API REST</h1>
<span id="author">Jorge Aguilera</span>
<br>
</section>
<section class="slide" id="__whoami">
<h2>$whoami</h2>
<table class="tableblock frame-all grid-all" style="width:100%">
<colgroup>
<col style="width:16.6666%">
<col style="width:83.3334%">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img alt="whoami" src="whoami.jpg"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jorge Aguilera, +20 a&ntilde;os d&aacute;ndole a la tecla</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&nbsp;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&nbsp;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img alt="pvida" height="100px" src="pvida.png" width="100px"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">y desde hace +9 a&ntilde;os como freelance (a.k.a. chico para todo) en Puravida Software</p></td>
</tr>
</tbody>
</table>
</section>
<section class="slide" id="_rest_tdd_d">
<h2>REST TDD&amp;D</h2>
<div class="paragraph"><p>Test Driven Development and Documenting a Grails Rest app</p></div>
<div class="paragraph slide"><p>o c&oacute;mo usar Spock para completar tu documentaci&oacute;n</p></div>
<div class="paragraph slide"><p>en realidad, c&oacute;mo hacer que documentas como un profesional mientras los test lo hacen por t&iacute;</p></div>
</section>
<section class="slide" id="_requisitos">
<h2>Requisitos</h2>
<div class="paragraph"><p>Te suena &#8230;&#8203;</p></div>
<div class="ulist">
<ul>
<li>Groovy &amp; Grails</li>
<li>Spock Framework</li>
<li>Asciidoctor</li>
<li>SOA &amp; REST</li>
</ul>
</div>
</section>
<section class="slide" id="_qu_vamos_a_ver">
<h2>Qu&eacute; vamos a ver.</h2>
<div class="openblock slide">
<div class="content">
<div class="ulist">
<ul>
<li>Objetivo: utilizar los test de tu aplicaci&oacute;n para que hagan el trabajo sucio de documentar nuestras APIs REST.
Porque si la documentaci&oacute;n no es v&aacute;lida, tus servicios NO SON VALIDOS (y viceversa,claro)</li>
</ul>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li class="slide">Un poco de historia (reciente, tranquilos)</li>
<li class="slide">TwitterPeople. Grails 3.x REST application</li>
<li class="slide">Spockear. Un poco de test nunca viene mal</li>
<li class="slide">Documentando. Que es a lo que hemos venido</li>
</ul>
</div>
</section>
<section class="slide" id="_objetivo">
<h2>Objetivo</h2>
<div class="paragraph"><p><strong>Nuestra documentaci&oacute;n en un formato legible y con especificaciones actualizadas</strong></p></div>
<div class="paragraph"><p><a href="index.html" target="_blank">Algo as&iacute;</a></p></div>
</section>
<section class="slide" id="_un_poco_de_rest_historia_personal">
<h2>Un poco de REST-historia (personal)</h2>
<div class="openblock slide">
<div class="content">
<div class="paragraph"><p>O de c&oacute;mo me dej&eacute; las pesta&ntilde;as con SOA&#8230;&#8203;</p></div>
<div class="paragraph"><p>que si primero el contrato vs que si primero el java
que si cabecera, que si security, que si payload, &#8230;&#8203;.</p></div>
</div>
</div>
<div class="openblock slide">
<div class="content">
<div class="paragraph"><p>y en tu radar suena REST..
y lo entiendes, y dices esto es para m&iacute;&#8230;&#8203;</p></div>
<div class="paragraph"><p>y adem&aacute;s Grails tiene un RestController</p></div>
<div class="paragraph"><p>&#8230;&#8203;y hasta un plugin para securizar las llamadas ( @alvaro_sanchez )</p></div>
<div class="paragraph"><p>&#8230;&#8203;pero no todo es tan f&aacute;cil,</p></div>
<div class="paragraph"><p>que si versi&oacute;n del API,</p></div>
<div class="paragraph"><p>que si POST o PUT&#8230;&#8203;</p></div>
</div>
</div>
</section>
<section class="slide" id="_el_camino_al_nirvana">
<h2>El camino al nirvana</h2>
<div class="ulist">
<ul>
<li class="slide">Llamadas RPC por todos lados.</li>
<li class="slide">Ofreces los datos de tus tablas.</li>
<li class="slide">Permites actualizar, e incluso borrar!!</li>
<li class="slide">Te gustar&iacute;a incluso enlazar recursos.</li>
</ul>
</div>
</section>
<section class="slide" id="_glory_of_rest_martin_fowler">
<h2>Glory of Rest (Martin Fowler)</h2>
<div class="imageblock">
<div class="content">
<img alt="glory of rest 1" src="glory_of_rest_1.png">
</div>
</div>
<div class="paragraph"><p><a class="bare" href="http://martinfowler.com/articles/richardsonMaturityModel.html">http://martinfowler.com/articles/richardsonMaturityModel.html</a></p></div>
</section>
<section class="slide" id="__y_la_documentaci_n">
<h2>&#8230;&#8203; y la documentaci&oacute;n ?</h2>
<div class="imageblock">
<div class="content">
<img alt="slack" src="slack.png">
</div>
</div>
</section>
<section class="slide" id="_twitterpeople">
<h2>TwitterPeople</h2>
<div class="paragraph"><p>Proxy de usuarios de Twitter</p></div>
<div class="paragraph"><p><a class="bare" href="https://github.com/jagedn/twitterpeople">https://github.com/jagedn/twitterpeople</a></p></div>
<div class="paragraph"><p>Solicitamos un recurso Person a nuestro servicio y si no lo tiene lo importa desde Twitter</p></div>
<div class="paragraph"><p>(Pod&iacute;amos hacer la t&iacute;pica aplicaci&oacute;n a base de datos, pero &#8230;&#8203;)</p></div>
</section>
<section class="slide" id="_twitterpeople_2">
<h2>TwitterPeople</h2>
<div class="listingblock">
<div class="content">
<pre class="CodeRay"><code class="console language-console">java -jar twitterpeople-0.1.jar</code></pre>
</div>
</div>
<div class="paragraph"><p><a href="http://localhost:8080/people/glaforge" target="_blank">Ejemplo en vivo</a></p></div>
<div class="imageblock">
<div class="content">
<img alt="glaforge" src="glaforge.png">
</div>
</div>
</section>
<section class="slide" id="_twitterpeople_3">
<h2>TwitterPeople</h2>
<div class="paragraph"><p>Documentando nuestro modelo:</p></div>
<table class="tableblock frame-all grid-rows" style="width:100%">
<caption class="title">Table 1. Person model</caption>
<colgroup>
<col style="width:33.3333%">
<col style="width:33.3333%">
<col style="width:33.3334%">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Path</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">user name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">description</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">followersCount</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">how many followers</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">friendsCount</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">how many friends</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">location</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the user location</p></td>
</tr>
</tbody>
</table>
</section>
<section class="slide" id="_domain">
<h2>Domain</h2>
<div class="paragraph"><p>Nuestro recurso en Grails:</p></div>
<div class="listingblock">
<div class="title">/src/grails-app/domain/twitterpeople/Person.groovy</div>
<div class="content">
<pre class="CodeRay"><code class="groovy language-groovy"><span class="keyword">package</span> twitterpeople

<span class="keyword">import</span> <span class="include">grails.rest.Resource</span>

<span class="annotation">@Resource</span>(uri=<span class="string"><span class="delimiter">'</span><span class="content">/people</span><span class="delimiter">'</span></span>, formats=[<span class="string"><span class="delimiter">'</span><span class="content">json</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">hal</span><span class="delimiter">'</span></span>], readOnly=<span class="predefined-constant">true</span>)
<span class="type">class</span> <span class="class">Person</span> {

    <span class="directive">static</span> constraints = {
        description <span class="key">nullable</span>:<span class="predefined-constant">true</span>
        location <span class="key">nullable</span>:<span class="predefined-constant">true</span>
    }

    <span class="directive">static</span> mapping = {
        id <span class="key">generator</span>: <span class="string"><span class="delimiter">'</span><span class="content">assigned</span><span class="delimiter">'</span></span>, <span class="key">type</span>:<span class="string"><span class="delimiter">'</span><span class="content">string</span><span class="delimiter">'</span></span>
    }

    <span class="predefined-type">String</span> id   <span class="comment">// usaremos el name en lugar del id de twitter</span>

    <span class="predefined-type">String</span> description
    <span class="type">int</span> followersCount
    <span class="type">int</span> friendsCount
    <span class="predefined-type">String</span> location
}</code></pre>
</div>
</div>
</section>
<section class="slide" id="_interceptor">
<h2>Interceptor</h2>
<div class="paragraph"><p>Interceptamos las peticiones GET /people/${id}</p></div>
<div class="listingblock">
<div class="title">/src/grails-app/controller/twitterpeople/PersonInterceptor</div>
<div class="content">
<pre class="CodeRay"><code class="groovy language-groovy"><span class="type">class</span> <span class="class">PersonInterceptor</span> {

    TwitterProxyService twitterProxyService

    <span class="type">boolean</span> before(){

        <span class="keyword">switch</span>( params.action ){
            <span class="keyword">case</span> <span class="string"><span class="delimiter">'</span><span class="content">show</span><span class="delimiter">'</span></span>:
                Person add = twitterProxyService.createPerson(params.id)
                <span class="keyword">if</span> (add &amp;&amp; add.validate()) {
                    add.save(<span class="key">flush</span>: <span class="predefined-constant">true</span>)
                }
            <span class="keyword">break</span>
        }

        <span class="predefined-constant">true</span>
    }

}</code></pre>
</div>
</div>
</section>
<section class="slide" id="_service">
<h2>Service</h2>
<div class="paragraph"><p>Buscando en twitter al usuario</p></div>
<div class="listingblock">
<div class="title">/src/grails-app/services/twitterpeople/TwitterProxyService</div>
<div class="content">
<pre class="CodeRay"><code class="groovy language-groovy"><span class="type">class</span> <span class="class">TwitterProxyService</span> {

    Twitter twitter

    Person createPerson( id ) {
        <span class="keyword">try</span> {
            Person add
            User user
            <span class="keyword">if</span> (<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>id</span><span class="delimiter">&quot;</span></span>.isNumber() == <span class="predefined-constant">false</span>) {
                add = Person.get(id)
                <span class="keyword">if</span> (add) {
                    <span class="keyword">return</span> add
                }
                user = twitter.showUser(<span class="string"><span class="delimiter">&quot;</span><span class="content">@</span><span class="inline"><span class="inline-delimiter">${</span>id<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
            } <span class="keyword">else</span> {
                user = twitter.showUser(id <span class="keyword">as</span> <span class="type">long</span>)
            }

            <span class="keyword">if</span> (user) {
                add = <span class="keyword">new</span> Person(user.properties)
                add.id = id
            }
            add
        }<span class="keyword">catch</span>( TwitterException te){
            te.printStackTrace()
            <span class="predefined-constant">null</span>
        }
    }
}</code></pre>
</div>
</div>
</section>
<section class="slide" id="_spockeando">
<h2>Spockeando</h2>
<div class="paragraph"><p>Como buen programador no liberamos nada sin probarlo primero.
RestBuilder es un buen ayudante para testear servicios REST</p></div>
<div class="listingblock">
<div class="title">/src/integration-test/groovy/twitterpeople/SimpleSpec</div>
<div class="content">
<pre class="CodeRay"><code class="groovy language-groovy"><span class="type">void</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">test user #username</span><span class="delimiter">&quot;</span></span>(){
    <span class="key">given</span>:
        RestBuilder rest = <span class="keyword">new</span> RestBuilder()
    <span class="key">when</span>:
        RestResponse response = rest.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8080/people/</span><span class="inline"><span class="inline-delimiter">${</span>username<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
    <span class="key">then</span>:
        response.status == <span class="integer">200</span>
        response.json.id == username
    <span class="key">where</span>:
        username | description
        <span class="string"><span class="delimiter">'</span><span class="content">jagedn</span><span class="delimiter">'</span></span> | <span class="string"><span class="delimiter">&quot;</span><span class="content">nooo, si yo ya....</span><span class="delimiter">&quot;</span></span>
        <span class="string"><span class="delimiter">'</span><span class="content">un_voluntario</span><span class="delimiter">'</span></span> | <span class="string"><span class="delimiter">'</span><span class="content">seguro que falla el test</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
</section>
<section class="slide" id="_liberando_twitterpeople">
<h2>Liberando TwitterPeople</h2>
<div class="listingblock">
<div class="content">
<pre class="CodeRay"><code class="console language-console">$gradle assemble</code></pre>
</div>
</div>
</section>
<section class="slide" id="_documentando">
<h2>Documentando</h2>
<div class="ulist">
<ul>
<li class="slide">Swagger, complet&iacute;simo &#8230;&#8203; supercomplicado.</li>
<li class="slide">JsonDoc, incorpora hasta un playground &#8230;&#8203; pero no funciona bien en Grails.</li>
</ul>
</div>
<div class="openblock slide">
<div class="content">
<div class="ulist">
<ul>
<li>Spring-rest-doc, esto ya empieza a ser otra cosa</li>
</ul>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph"><p>Spring REST Docs helps you to document <strong>RESTful services</strong>.
It combines <strong>hand-written</strong> documentation written with <strong>Asciidoctor</strong> and <strong>auto-generated snippets</strong>
 produced with Spring MVC Test.</p></div>
</div>
</div>
<div class="paragraph"><p><a class="bare" href="http://projects.spring.io/spring-restdocs">http://projects.spring.io/spring-restdocs</a></p></div>
</div>
</div>
<div class="openblock slide">
<div class="content">
<div class="ulist">
<ul>
<li>rest-assured, extenso DSL orientado a testear servicios REST</li>
</ul>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph"><p>Testing and validation of REST services in Java is harder than in dynamic languages such as Ruby and Groovy.
REST Assured brings the simplicity of using these languages into the Java domain.</p></div>
</div>
</div>
<div class="paragraph"><p><a class="bare" href="https://github.com/jayway/rest-assured">https://github.com/jayway/rest-assured</a></p></div>
</div>
</div>
</section>
<section class="slide" id="_step_by_step">
<h2>Step by step &#8230;&#8203;</h2>
<div class="ulist">
<ul>
<li class="slide"><a href="../../../blog/2016/twitterpeople_2_2.html#configurando_dependencias" target="_blank">Preparar entorno</a></li>
<li class="slide"><a href="../../../blog/2016/twitterpeople_2_2.html#preparando_nuestra_documentaci&oacute;n" target="_blank">Preparando documentaci&oacute;n</a></li>
<li class="slide"><a href="../../../blog/2016/twitterpeople_2_2.html#basespec" target="_blank">Preparando nuestros Specs</a></li>
<li class="slide"><a href="../../../blog/2016/twitterpeople_2_2.html#creando_un_spec" target="_blank">Nuestro primer Spec</a></li>
<li class="slide"><a href="../../../blog/2016/twitterpeople_2_2.html#creando_otro_spec" target="_blank">Otro Spec mas complejo</a></li>
<li class="slide"><a href="../../../blog/2016/twitterpeople_2_2.html#build" target="_blank">Compilar</a></li>
<li class="slide"><a href="http://localhost:8080/people/jagedn" target="_blank">Vive!!!</a></li>
<li class="slide"><a href="http://localhost:8080/static/docs/index.html" target="_blank">Visualizando la documentaci&oacute;n in-situ</a></li>
<li class="slide">&#8230;&#8203;.Nuevas especificaciones, nuevos cambios, nueva documentaci&oacute;n, vamos all&aacute;</li>
</ul>
</div>
</section>
<section class="slide" id="_domain_2">
<h2>Domain</h2>
<div class="paragraph"><p>Nuestro recurso en Grails:</p></div>
<div class="listingblock">
<div class="title">/src/grails-app/domain/twitterpeople/Person.groovy</div>
<div class="content">
<pre class="CodeRay"><code class="groovy language-groovy"><span class="keyword">package</span> twitterpeople

<span class="keyword">import</span> <span class="include">grails.rest.Resource</span>

<span class="annotation">@Resource</span>(uri=<span class="string"><span class="delimiter">'</span><span class="content">/people</span><span class="delimiter">'</span></span>, formats=[<span class="string"><span class="delimiter">'</span><span class="content">json</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">hal</span><span class="delimiter">'</span></span>], readOnly=<span class="predefined-constant">true</span>)
<span class="type">class</span> <span class="class">Person</span> {

    <span class="directive">static</span> constraints = {
        description <span class="key">nullable</span>:<span class="predefined-constant">true</span>
        location <span class="key">nullable</span>:<span class="predefined-constant">true</span>
    }

    <span class="directive">static</span> mapping = {
        id <span class="key">generator</span>: <span class="string"><span class="delimiter">'</span><span class="content">assigned</span><span class="delimiter">'</span></span>, <span class="key">type</span>:<span class="string"><span class="delimiter">'</span><span class="content">string</span><span class="delimiter">'</span></span>
    }

    <span class="predefined-type">String</span> id   <span class="comment">// usaremos el name en lugar del id de twitter</span>

    <span class="predefined-type">String</span> description
    <span class="type">int</span> followersCount
    <span class="type">int</span> friendsCount
    <span class="predefined-type">String</span> location

    <span class="predefined-type">Date</span>    dateCreated  <b class="conum">(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Ahora queremos saber cuando se ha creado en nuestro sistema</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay"><code class="console language-console">$gradle assemble</code></pre>
</div>
</div>
<div class="paragraph"><p>WTF ?????</p></div>
</section>
<section class="slide" id="_spring_rest_docs">
<h2>Spring REST docs:</h2>
<div class="ulist">
<ul>
<li>curl-request.adoc</li>
<li>http-request.adoc</li>
<li>http-response.adoc</li>
<li>request-headers.adoc</li>
<li>response-headers.adoc</li>
<li>links.adoc</li>
<li>request-parameters.adoc</li>
<li>path-parameters.adoc</li>
<li>document("apelo")</li>
<li>document("${a_groovy_logic}")</li>
<li>document("{class-name}/{method-name}")</li>
</ul>
</div>
</section>
<section class="slide" id="_rest_assured_dsl">
<h2>Rest assured DSL</h2>
<div class="listingblock">
<div class="content">
<pre class="CodeRay"><code class="groovy language-groovy">get(<span class="string"><span class="delimiter">&quot;</span><span class="content">/lotto</span><span class="delimiter">&quot;</span></span>).then().assertThat().body(<span class="string"><span class="delimiter">&quot;</span><span class="content">lotto.lottoId</span><span class="delimiter">&quot;</span></span>, equalTo(<span class="integer">5</span>));

get(<span class="string"><span class="delimiter">&quot;</span><span class="content">/lotto</span><span class="delimiter">&quot;</span></span>).then().assertThat().body(<span class="string"><span class="delimiter">&quot;</span><span class="content">lotto.winners.winnerId</span><span class="delimiter">&quot;</span></span>, hasItems(<span class="integer">23</span>, <span class="integer">54</span>));

given().
    param(<span class="string"><span class="delimiter">&quot;</span><span class="content">key1</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">value1</span><span class="delimiter">&quot;</span></span>).
    param(<span class="string"><span class="delimiter">&quot;</span><span class="content">key2</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">value2</span><span class="delimiter">&quot;</span></span>).
when().
    post(<span class="string"><span class="delimiter">&quot;</span><span class="content">/somewhere</span><span class="delimiter">&quot;</span></span>).
then().
    body(containsString(<span class="string"><span class="delimiter">&quot;</span><span class="content">OK</span><span class="delimiter">&quot;</span></span>));

<span class="predefined-type">String</span> json = get(<span class="string"><span class="delimiter">&quot;</span><span class="content">/lotto</span><span class="delimiter">&quot;</span></span>).asString()
<span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; winnderIds = from(json).get(<span class="string"><span class="delimiter">&quot;</span><span class="content">lotto.winners.winnerId</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
</section>
<section class="slide" id="_links_e_info">
<h2>Links e Info</h2>
<div class="ulist">
<ul>
<li>@jagedn Jorge Aguilera (me), 20+ a&ntilde;os d&aacute;ndole a la tecla</li>
<li>@pvidasoftware Puravida Software, Open source, open mind</li>
<li>Grails (<a class="bare" href="http://www.grails.org">http://www.grails.org</a>)</li>
<li>Spock (<a class="bare" href="http://spockframework.org">http://spockframework.org</a>)</li>
<li>spring-rest-doc (projects.spring.io/spring-restdocs)</li>
<li>rest-assured (<a class="bare" href="https://github.com/jayway/rest-assured">https://github.com/jayway/rest-assured</a>)</li>
<li>AsciiDoc (<a class="bare" href="http://asciidoctor.org">http://asciidoctor.org</a>)</li>
<li>@JennStrater <a class="bare" href="https://github.com/jlstrater/gr8data">https://github.com/jlstrater/gr8data</a></li>
</ul>
</div>
</section>
<section class="slide canvas-image" id="_gracias" style="background-image: url(../../gracias_multilingue.jpg)">

</section>
<div aria-role="navigation">
<a class="deck-prev-link" href="#" title="Previous">&#8592;</a>
<a class="deck-next-link" href="#" title="Next">&#8594;</a>
</div>
<p aria-role="status" class="deck-status">
<span class="deck-status-current"></span>
/
<span class="deck-status-total"></span>
</p>
<form action="." class="goto-form" method="get">
<label for="goto-slide">Go to Slide:</label>
<input id="goto-slide" list="goto-datalist" name="slidenum" type="text">
<datalist id="goto-data-list"></datalist>
<input type="submit" value="Go">
</form>
</div>
<script src="/blog/js/jquery-1.11.1.min.js"></script>
<script src="/blog/deck/core/deck.core.js"></script>
<script src="/blog/deck/extensions/scale/deck.scale.js"></script>
<script src="/blog/deck/extensions/goto/deck.goto.js"></script>
<script src="/blog/deck/extensions/navigation/deck.navigation.js"></script>
<script src="/blog/deck/extensions/status/deck.status.js"></script>
<script>
  (function($, deck, undefined) {
    $.deck.defaults.keys['previous'] = [8, 33, 37, 39];
    $.deck.defaults.keys['next'] = [13, 32, 34, 39];
  
    $.extend(true, $[deck].defaults, {
        countNested: false
    });
  
    $.deck('.slide');
  })(jQuery, 'deck');
</script>
<style>
  .slide.canvas-image {
  -moz-background-size: contain;
  -webkit-background-size: contain;
  -o-background-size: contain;
  background-size: contain;
  display: -moz-box;
  display: -webkit-box;
  display: -ms-box;
  display: box;
  -moz-box-orient: vertical;
  -webkit-box-orient: vertical;
  -ms-box-orient: vertical;
  box-orient: vertical;
  -moz-box-align: start;
  -webkit-box-align: start;
  -ms-box-align: start;
  box-align: start;
  -moz-box-pack: start;
  -webkit-box-pack: start;
  -ms-box-pack: start;
  box-pack: start;}
  
  .bottom-left {
    left: 1%;
    bottom: 20%; }
  
  .top-left {
    left: 1%;
    top: 20%; }
  
  .bottom-right {
    right: 1%;
    bottom: 20%; }
  
  .top-right {
    right: 1%;
    top: 20%; }
  
  .center-up {
    right: 50%;
    top: 1%;
  }
  
  .center-down {
    right: 50%;
    bottom: 1%;
  }
  .canvas-image .canvas-caption p {
    text-align: center;
    padding-top: 0;
    padding: 0;
    -moz-transform: none;
    -webkit-transform: none;
    -o-transform: none;
    -ms-transform: none;
    transform: none;
    display: inline;
    position: absolute;
    background-color: rgba(0, 0, 0, 0.7);
    font-weight: bold;
    font-size: 58px;
    -webkit-box-shadow: 2px 2px 2px #000;
    -moz-box-shadow: 2px 2px 2px #000;
    box-shadow: 2px 2px 2px #000;
    padding: 1rem;
    color: white; }
  kbd.keyseq { color: #555555; }
  kbd:not(.keyseq) {
    display: inline-block;
    color: #222222;
    font-size: 0.7em;
    line-height: 1.4;
    background-color: #F7F7F7;
    border: 1px solid #ccc;
    -webkit-border-radius: 3px;
    border-radius: 3px;
    -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset;
    box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset;
    margin: -0.15em 0.15em 0 0.15em;
    padding: 0.2em 0.6em;
    vertical-align: middle;
    white-space: nowrap;
  }
  kbd kbd:first-child { margin-left: 0; }
  kbd kbd:last-child { margin-right: 0; }
</style>
</body>
</html>